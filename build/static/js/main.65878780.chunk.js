(this["webpackJsonpreact-ccs-annotator"]=this["webpackJsonpreact-ccs-annotator"]||[]).push([[0],{419:function(e,t){},421:function(e,t){},495:function(e,t,n){"use strict";n.r(t);n(359);var r=n(0),a=n.n(r),c=n(99),o=n.n(c),i=n(344),s=n(54),u=n(336),l=n.n(u),d=n(339),h=n(547),b=n(163),j=n(44),p=n(17),v=n.n(p),f=n(30),O=n(23),x=n(274),k=n.n(x);function g(e,t,n){return m.apply(this,arguments)}function m(){return(m=Object(j.a)(v.a.mark((function e(t,n,r){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.get("".concat(t,"/token"),{auth:{username:n,password:r}});case 2:return a=e.sent,e.abrupt("return",a.data.token);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=function(){function e(t,n,r){Object(f.a)(this,e),this.host=t,this.email=n,this.token=r,this.api=k.a.create({baseURL:t,headers:{Authorization:"Bearer ".concat(r)}})}return Object(O.a)(e,[{key:"init",value:function(){var e=Object(j.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g();case 3:console.log(this.email),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"getJobs",value:function(){var e=Object(j.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("/codingjobs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getToken",value:function(){var e=Object(j.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("/token");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCodebook",value:function(){var e=Object(j.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("/codingjob/".concat(t,"/codebook"));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getProgress",value:function(){var e=Object(j.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("/codingjob/".concat(t,"/progress"));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUnit",value:function(){var e=Object(j.a)(v.a.mark((function e(t,n){var r,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/codingjob/".concat(t,"/unit"),null!==n&&(r+="?index=".concat(n)),e.next=4,this.api.get(r);case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getCodingjob",value:function(){var e=Object(j.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("/codingjob/".concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"postCodingjob",value:function(e,t){return e.title=t,this.api.post("/codingjob",{title:t,units:e.units,codebook:e.codebook,provenance:e.provenance,rules:e.rules})}},{key:"postAnnotation",value:function(e,t,n,r){var a={annotation:n,status:r};this.api.post("/codingjob/".concat(e,"/unit/").concat(t,"/annotation"),a)}}]),e}(),y=w,C=n(120),A=n(273),S=n(545),R=n(546),_=n(334),J=n(9),L=function(){var e=Object(j.a)(v.a.mark((function e(t,n,r){var a,c,o,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new y(null===t||void 0===t||null===(a=t.backend)||void 0===a?void 0:a.host,null===t||void 0===t||null===(c=t.backend)||void 0===c?void 0:c.email,null===t||void 0===t||null===(o=t.backend)||void 0===o?void 0:o.token),e.prev=1,e.next=4,i.init();case 4:r(i),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),r(null),n("backend",JSON.stringify(Object(b.a)(Object(b.a)({},i),{},{token:null})),{path:"/"});case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),P=function(e){var t=e.host,n=void 0===t?null:t,r=Object(_.a)(["backend"]),a=Object(s.a)(r,2),c=a[0],o=a[1],i=c.backend||{host:"http://localhost:5000",email:"test@user.com",token:null};n&&(i.host=n);return i.token?Object(J.jsx)(U,{backend:i,setLogout:function(){o("backend",JSON.stringify(Object(b.a)(Object(b.a)({},i),{},{token:null})),{path:"/"})}}):Object(J.jsx)(I,{backend:i,setLogin:function(e){o("backend",JSON.stringify(e),{path:"/"})}})},U=function(e){var t=e.backend,n=e.setLogout;return Object(J.jsx)(J.Fragment,{children:Object(J.jsx)(d.a,{textAlign:"center",children:Object(J.jsx)(d.a.Column,{children:Object(J.jsxs)(C.a,{secondary:!0,onClick:n,children:["Sign out from ",Object(J.jsx)("span",{style:{color:"lightblue"},children:t.email})]})})})})},I=function(e){var t=e.backend,n=e.setLogin,a=Object(r.useState)(""),c=Object(s.a)(a,2),o=c[0],i=c[1],u=Object(r.useState)(""),l=Object(s.a)(u,2),b=l[0],p=l[1],f=Object(r.useState)(""),O=Object(s.a)(f,2),x=O[0],k=O[1],m=Object(r.useState)(!1),w=Object(s.a)(m,2),y=w[0],_=w[1],L=function(){var e=Object(j.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(""),e.prev=1,e.next=4,g(o,b,x);case 4:t=e.sent,n({host:o,email:b,token:t}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),_(!0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),P=!b.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return Object(r.useEffect)((function(){null!==t&&void 0!==t&&t.email&&p(t.email),null!==t&&void 0!==t&&t.host&&i(t.host)}),[t]),Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(h.a,{icon:"user",content:"Register or sign in"}),Object(J.jsxs)(A.a,{placeholder:!0,attached:"bottom",children:[Object(J.jsx)(d.a,{stackable:!0,textAlign:"center",children:Object(J.jsx)(d.a.Row,{children:Object(J.jsx)(d.a.Column,{children:Object(J.jsxs)(S.a,{children:[Object(J.jsx)(S.a.Input,{placeholder:"Host",name:"host",label:"Host",value:o,onChange:function(e,t){t.value.length<100&&i(t.value)},icon:"home",iconPosition:"left",autoFocus:!0}),Object(J.jsx)(S.a.Input,{placeholder:"email adress",error:!!P&&"Please enter a valid email adress",name:"email",label:"Email",icon:"mail",iconPosition:"left",value:b,onChange:function(e,t){t.value.length<100&&p(t.value)}})]})})})}),Object(J.jsx)(R.a,{}),Object(J.jsx)(d.a,{columns:2,textAlign:"center",children:Object(J.jsxs)(d.a.Row,{verticalAlign:"middle",children:[Object(J.jsx)(d.a.Column,{children:Object(J.jsx)(S.a,{children:Object(J.jsx)(C.a,{circular:!0,primary:!0,fluid:!0,style:{width:"7em",height:"7em"},children:"Login by email (not yet functional)"})})}),Object(J.jsx)(R.a,{vertical:!0,children:"Or"}),Object(J.jsx)(d.a.Column,{children:Object(J.jsxs)(S.a,{children:[Object(J.jsx)(S.a.Input,{placeholder:"password",name:"password",error:!!y&&"Invalid password for this host & email",label:"Password",type:"password",icon:"lock",iconPosition:"left",value:x,onChange:function(e,t){_(!1),k(t.value)}}),Object(J.jsx)(C.a,{disabled:0===x.length,primary:!0,fluid:!0,onClick:L,children:"Sign in"})]})})]})})]})]})},F=function(e){var t,n=Object(_.a)(["backend"]),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(null),u=Object(s.a)(i,2),l=u[0],d=u[1];return Object(r.useEffect)((function(){var t,n,r,a=e||(null===c||void 0===c||null===(t=c.backend)||void 0===t?void 0:t.host)||null;a&&a!==(null===l||void 0===l?void 0:l.host)&&d(null),null!==c&&void 0!==c&&null!==(n=c.backend)&&void 0!==n&&n.token?!l&&a&&null!==c&&void 0!==c&&null!==(r=c.backend)&&void 0!==r&&r.token&&L(c,o,d):d(null)}),[c,l,e,o,d]),[l,Object(J.jsx)(P,{host:e||(null===c||void 0===c||null===(t=c.backend)||void 0===t?void 0:t.host)||null})]},E=function(){function e(t,n){Object(f.a)(this,e),this.backend=t,this.job_id=n,this.where="remote"}return Object(O.a)(e,[{key:"init",value:function(){var e=Object(j.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.backend.getCodebook(this.job_id);case 3:return this.codebook=e.sent,e.next=6,this.backend.getProgress(this.job_id);case 6:this.progress=e.sent,e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(0),console.log(e.t0),this.success=!1,e.abrupt("return");case 14:this.success=!0;case 15:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"getUnit",value:function(){var e=Object(j.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t>=this.progress.n_coded&&!this.progress.seek_forwards,this.progress.n_coded=Math.max(t,this.progress.n_coded),e.next=4,this.backend.getUnit(this.job_id,n?null:t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"postAnnotations",value:function(e,t,n){this.backend.postAnnotation(this.job_id,e,t,n)}}]),e}(),z=E,N=function(e){var t=e.backend,n=e.loginForm;return t.getJobs().then((function(e){return console.log(e)})),Object(J.jsxs)(d.a,{inverted:!0,textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:[Object(J.jsx)(d.a.Row,{children:Object(J.jsxs)(d.a.Column,{children:[Object(J.jsx)(h.a,{children:t.host}),n]})}),Object(J.jsx)(d.a.Row,{children:"test"})]})},H=function(e,t){var n=Object(r.useState)(null),a=Object(s.a)(n,2),c=a[0],o=a[1];return Object(r.useEffect)((function(){if(e&&t){var n=new z(e,t);n.init().then((function(){return o(n)}))}else o(null)}),[e,t]),c},M=function(e){var t,n=null===(t=e.split("?"))||void 0===t?void 0:t[1];if(!n)return[null,null];var r=n.split("&").reduce((function(e,t){var n=t.split("="),r=Object(s.a)(n,2),a=r[0],c=r[1];return e[decodeURIComponent(a)]=decodeURIComponent(c),e}),{});if(!r.url)return[null,null];var a=new URL(r.url);return[a.origin,a.pathname.split("/").slice(-1)[0]]},Z=function(){var e=M(window.location.href),t=Object(s.a)(e,2),n=t[0],r=t[1],a=F(n),c=Object(s.a)(a,2),o=c[0],i=c[1],u=H(o,r);return o?u?Object(J.jsx)(l.a,{jobServer:u}):Object(J.jsx)(N,{backend:o,loginForm:i}):Object(J.jsx)(d.a,{inverted:!0,textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(J.jsx)(d.a.Column,{style:{maxWidth:"500px"},children:i})})},q=function(){return Object(J.jsx)(i.a,{basename:"/",children:Object(J.jsx)("div",{style:{height:"100vh",width:"100vw"},children:Object(J.jsx)(Z,{})})})},B=n(322);o.a.render(Object(J.jsx)(a.a.StrictMode,{children:Object(J.jsx)(B.a,{children:Object(J.jsx)(q,{})})}),document.querySelector("#root"))}},[[495,1,2]]]);
//# sourceMappingURL=main.65878780.chunk.js.map